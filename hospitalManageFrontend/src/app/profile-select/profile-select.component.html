<div class="fone">
<div class="container">
  <br>
  <br>
  <br>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark rounded">
    <a class="navbar-brand" href="#">Hospital</a>
    <button class="navbar-toggler" type="button" >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a style="cursor: pointer;" (click)="OnToUsersList()" class="nav-link" >
            <i class="fas fa-home-lg-alt"></i>
            Back To Menu</a>
        </li>
        <li class="nav-item">
          <a style="cursor: pointer;" routerLink="/analize/card" class="nav-link">
            <i class="fas fa-microscope"></i>
            Analize Card</a>
        </li>
        <li class="nav-item">
          <a style="cursor: pointer;" routerLink="/treatments/card" class="nav-link">
            <i class="fas fa-pills"></i>
            Treatment Card</a>
        </li>
      </ul>
    </div>
  </nav>
  <br>



  <div class="container">
    <div class="main-body">
      <div class="row">
        <div class="col-lg-4">
          <div class="card">
            <div class="card-body">
              <div class="d-flex flex-column align-items-center text-center">
                <a style="cursor: pointer;" (change)="!flag" id="changeProfileImage" data-toggle="modal"
                   data-target="#changeImage"><img src="{{select?.profileImageUrl}}" alt="Admin"
                                                   class="rounded-circle p-1 bg-primary" width="110"></a>

                <div class="mt-3">
                  <h4>{{select.firstname}} {{select.lastname}}</h4>
                  <p class="text-secondary mb-1">{{select.role.substring(5)}}</p>
                  <p class="text-muted font-size-sm">{{select.address}}</p>
                </div>

                <div>
                  <small *ngIf="select.online">Online</small>
                  <small *ngIf="!select.online">Offline</small>
                </div>

              </div>
              <hr class="my-4">
              <ul class="list-group list-group-flush">
                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                  <h6 class="mb-0">
                    <i class="fas fa-hospital-user"></i>
                    Hospitalization
                  </h6>
                  <span class="text-secondary">
                      <i class="fas fa-procedures" [hidden]="!select.hospiztalization"></i>
                    </span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                  <h6 class="mb-0">
                    <i class="fas fa-microscope"></i>
                    Analyze
                  </h6>
                  <span class="text-secondary">
                      {{select.diagnosis.length}}
                    </span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                  <h6 class="mb-0">
                    <i class="fas fa-pills"></i>
                    Treatments
                  </h6>
                  <span class="text-secondary">
                      {{select.treatment.length}}
                    </span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                  <h6 class="mb-0">
                    <i class="fas fa-syringe"></i>
                    Code Vaccination
                  </h6>
                  <span class="text-secondary">
                      {{select.qrcode}}</span>
                </li>
              </ul>
            </div>
          </div>

          <div [hidden]="flag" class="card" style="margin-bottom: 5px; margin-top: 5px">

            <div class="btn-toolbar justify-content-center">

              <button class="btn btn-dark btn-sm mr-2 ml-2" type="button" data-toggle="modal"
                      data-target="#settingsICD"><small>ICD</small>
                <i class="fas fa-user-cog"></i>
              </button>

              <button class="btn btn-dark btn-sm mr-2 ml-2" type="button" data-toggle="modal"
                      data-target="#treatment"><small>Treatment</small>
                <i class="fas fa-stethoscope"></i>
              </button>

              <button class="btn btn-dark btn-sm mr-2 ml-2" type="button" data-toggle="modal"
                      data-target="#gospitalization">
                <i class="fas fa-procedures"></i>
              </button>

              <button class="btn btn-dark btn-sm mr-2 ml-2" routerLink="/operation/info" type="button"
                      id="operationInfo"><small>Operations</small>
                <i class="fas fa-photo-video"></i>
              </button>
            </div>
          </div>

          <div [hidden]="flag" class="card">

            <div class="btn-toolbar justify-content-center">

              <button class="btn btn-danger btn-sm mr-2 ml-2" data-toggle="modal" data-target="#deleteModal" type="button" data-toggle="modal"><small>Delete</small>
                <i class="fas fa-eraser"></i>
              </button>

              <button class="btn btn-warning btn-sm mr-2 ml-2"  data-toggle="modal" data-target="#changeAccess" type="button" data-toggle="modal"><small>Access</small>
                <i class="fas fa-wrench"></i>
              </button>
            </div>
          </div>
        </div>

        <form #updateProfile="ngForm" class="col-lg-8">
          <div class="card">
            <div class="text-primary" (click)="onSettings()">
              <i class="fas fa-cogs float-end"></i>
            </div>
            <div class="card-body">
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">First name</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="firstname" ngModel
                         [(ngModel)]="select.firstname" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Last name</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="lastname" ngModel
                         [(ngModel)]="select.lastname" required>

                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Patronomic</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="patronomic" ngModel
                         [(ngModel)]="select.patronomic" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Age</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="number" onkeyup="this.value=this.value.replace(/[^0-9]/g,'');"
                         class="form-control" name="age" ngModel
                         [(ngModel)]="select.age" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Username</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="username" ngModel
                         [(ngModel)]="select.username" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Email</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="email" class="form-control" name="email" ngModel
                         [(ngModel)]="select.email" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">QRCODE</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="QRCODE" ngModel
                         [(ngModel)]="select.qrcode" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Address</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="address" ngModel
                         [(ngModel)]="select.address" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Complaint</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="infoAboutComplaint" ngModel
                         [(ngModel)]="select.infoAboutComplaint" required>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Sick</h6>
                </div>
                <div class="col-sm-9 text-secondary">
                  <input [disabled]="flag || settingsFlag" type="text" class="form-control" name="infoAboutSick" ngModel
                         [(ngModel)]="select.infoAboutSick" required>
                </div>
              </div>
              <div [hidden]="managmentFlag" class="row mb-3">
                <div class="col-sm-3">
                  <h6 class="mb-0">Time to visit doctor</h6>
                </div>
<!--                <div class="col-sm-9 text-secondary text-center justify-content-center align-content-center">-->
<!--                  <input  type="datetime-local" id="dataTime" class="form-control border border-dark" name="timeToVisitAt">-->
<!--                  <button [hidden]="managmentFlag"  name="timeVisit" type="button" #time="ngModel" (ngModelChange)="changeTimeVisit(se)"-->
<!--                          [disabled]="updateProfile.invalid" class="btn btn-sm btn-dark">-->
<!--                    <i *ngIf="loadIcon" class="fa fa-sync fa-spin"></i>-->
<!--                    Save time visit-->
<!--                  </button>-->
<!--                </div>-->
                //TODO wtite time visit!!

              </div>
              <div class="row">
                <div class="col-sm-3"></div>
                <div class="col-sm-9 text-secondary">
                  <button [hidden]="flag || settingsFlag" type="button" (click)="changeProfile()"
                          [disabled]="updateProfile.invalid" class="btn btn-primary px-4">
                    <i *ngIf="loadIcon" class="fa fa-sync fa-spin"></i>
                    Save changes
                  </button>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<!--modal image profile change-->

<div class="modal" tabindex="-1" role="dialog" id="changeImage">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Change image.</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Take image in your computer</p>
        <form #newProfileImage="ngForm">
          <div class="custom-file">
            <input [disabled]="flag" type="file" name="file" class="form-control" ngModel
                   (change)="changeProfileImage($event.target.files[0])">
            <label class="custom-file-control"><span [hidden]="!filename">{{ filename }}</span>
              <span [hidden]="filename">Choose your image</span>
            </label>
          </div>
          <button type="submit" style="display: none" id="new-user-save"></button>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" id="close-change-image" data-dismiss="modal">Close</button>
        <button type="button" (click)="saveNewProfileImage()" [disabled]="newProfileImage.invalid"
                class="btn btn-primary">Save changes
        </button>

      </div>
    </div>
  </div>
</div>


<!--info diagnosis-->

<div class="container">
  <div class="modal fade bd-example-modal-lg" id="settingsICD" tabindex="-1" role="dialog" aria-labelledby=""
       aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-center" id="edit">Add ICD for user: {{select.firstname}}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div>
            <form #editDiagnosisForm="ngForm">
              <div class="from-group">
                <div class="btn-group mr-2 ">
                  <form class="form-inline my-2 my-lg-0 justify-content-center">
                    <input name="searchTerm" id="searchICD" #searchInput="ngModel" ngModel
                           (ngModelChange)="searchICD(searchInput.value)"
                           class="form-control mr-sm-2" type="search" placeholder="Search ICD...">
                  </form>
                </div>

                <div class="col-form-label" for="listInvestigation">Diagnosis: {{selectICD?.value}}
                  <button type="button" class="btn btn-primary btn-sm" (click)="addToICDList(selectICD)">
                    <i class="fas fa-plus">Add to list</i>
                  </button>
                </div>


                <table class="table table-sm">

                  <thead class="thead-dark">
                  <tr>
                    <th scope="col">NUMBER ICD</th>
                    <th scope="col">VALUE ICD</th>
                    <th scope="col">DELETE</th>
                  </tr>
                  </thead>
                  <tbody *ngFor="let icd of listICD">
                  <tr>
                    <td>{{icd.code}}</td>
                    <td>{{icd.value}}</td>
                    <td>
                      <button class="btn btn-outline-danger" (click)="deleteICDFromList(icd)">
                        <i class="fas fa-trash small"></i>
                      </button>
                    </td>
                  </tr>
                  </tbody>
                </table>

              </div>
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="close-edit-modal">Close</button>
          <button type="button" (click)="sendListICD()" [disabled]="editDiagnosisForm.invalid"
                  class="btn btn-primary px-4">
            Save changes
          </button>
        </div>
      </div>
    </div>
  </div>
</div>


<!--Edit treatment-->

<div class="container">
  <div class="modal fade bd-example-modal-lg" id="treatment" tabindex="-1" role="dialog" aria-labelledby=""
       aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-center" id="editTreatment">Patient: {{select.firstname}} {{select.lastname}}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form #editTreatmentForm="ngForm">
            <div class="from-group">
              <h5 class="text-center">Treatment add to patient</h5>
              <div class="row">
                <div class="input-group">
                  <textarea id="trt" class="form-control" aria-label="With textarea" ngModel name="treatment"
                            value="Put on the text..."></textarea>
                </div>
              </div>
              <br>
              <button type="submit" class="btn btn-primary btn-sm" [disabled]="editTreatmentForm.invalid"  (click)="addTreatment(editTreatmentForm)">
                <i class="far fa-share-square">Add notice</i>
              </button>
              <br>
              <br>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="close-edit-modal">Close</button>
        </div>

      </div>
    </div>
  </div>
</div>


<div class="container">
  <div class="modal fade bd-example-modal-lg" id="gospitalization" tabindex="-1" role="dialog" aria-labelledby=""
       aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-center" id="editGospitalization">Patient:  {{select.firstname}}</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div>
            <form #editHospitalizationForm="ngForm">

              <div class="form-group">
                <label for="hospitalizatoon">HOSPITALIZATION: </label>
                <select name="hospitalization" required ngModel [(ngModel)]="select.hospiztalization"
                        class="form-control">
                  <option value="true">YES</option>
                  <option value="false">NO</option>
                </select>
              </div>
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal" id="close-edit-modal-hospitalization">
            Close
          </button>
          <button type="button" (click)="changeHospitalization(editHospitalizationForm.value)"
                  [disabled]="editHospitalizationForm.invalid" class="btn btn-primary">Save
            changes
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<div class="modal" tabindex="-1" role="dialog" id="changeAccess">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="container ">
        <div class="modal-header modal-lg">
          <h4 class="modal-title text-center" id="modalAccess">Access account</h4>
          <button (click)="close()" type="button" class="close" id="closeModal" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
        <form #updateAccessProfile="ngForm" class="col-lg-8">

                <div class="form-group text-center justify-content-center">
                  <label class="float-left">Role</label>
                  <select name="role"  required ngModel id="role" class="form-control">
                    <option value="ROLE_USER">USER</option>
                    <option value="ROLE_SECRETARY">SECRETARY</option>
                    <option value="ROLE_DOCTOR">DOCTOR</option>
                    <option value="ROLE_ADMIN">ADMIN</option>
                    <option value="ROLE_SUPER_ADMIN">SUPER ADMIN</option>
                  </select>
                </div>
          <div class="form-group">
            <label for="Block account">Unlock account: </label>
            <select name="isNotLocked"  required ngModel id="isNotLocked"
                    class="form-control">
              <option value="true">YES</option>
              <option value="false">NO</option>
            </select>
          </div>
              <div class="row">
                <div class="col-sm-3"></div>
                <div class="col-sm-9 text-secondary">
                  <button type="button"  class="close" id="closeModal" data-dismiss="modal" (click)="updateAccessSelectProfile(updateAccessProfile)"
                          [disabled]="updateAccessProfile.invalid" class="btn btn-primary px-4">
                    <i *ngIf="loadIcon" class="fa fa-sync fa-spin"></i><i *ngIf="!loadIcon" class="fas fa-sync"></i>
                    Save changes
                  </button>
                </div>
              </div>
        </form>
        </div>

      </div>

    </div>
  </div>
</div>

<div class="modal" tabindex="-1" role="dialog" id="deleteModal">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="container justify-content-center text-center">
        <div class="modal-header modal-lg">
          <h4 class="modal-title text-center" id="modalQuestion">Remove account</h4>
          <button (click)="close()" type="button" class="close" id="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>



        <form class="form-group" >
          <div class="form-group justify-content-center text-center">
            <label class="text-center">Please put selected username to confirm.</label>
          </div>
          <input #remove="ngModel" class="text-center justify-content-sm-between" type="text" ngModel required name="username" id="username"/>
        </form>

        <div class="btn-group">
          <button  type="button" class="btn btn-outline-danger" [disabled]="remove.invalid" (click)="validUsername(remove.value)">I understand the consequences, delete account</button>
        </div>
        <div class="modal-footer">
          <button  type="button" class="close" data-dismiss="modal" aria-label="Close" class="btn btn-secondary" (click)="close()">Close</button>
        </div>
      </div>

    </div>
  </div>
</div>
